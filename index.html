<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consumo de Diésel</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="vista-login">
        <div class="login-container">
            <div class="header-content">
                <img src="logo.jpg" alt="Logo Obreco" class="header-logo">
                <div class="header-titles">
                    <h1>GRUPO OBRECO CIA LTDA</h1>
                    <h2>CONTROL DE DIESEL</h2>
                </div>
            </div>
            <form id="login-form">
                <h3>Iniciar Sesión</h3>
                <input type="email" id="login-email" placeholder="Correo electrónico" required>
                <input type="password" id="login-password" placeholder="Contraseña" required>
                <button type="submit" class="button-primary">Ingresar</button>
            </form>
        </div>
    </div>

    <div id="vista-app" style="display: none;">
        <div class="header-container">
            <div class="header-content">
                <img src="logo.jpg" alt="Logo Obreco" class="header-logo">
                <div class="header-titles">
                    <h1>GRUPO OBRECO CIA LTDA</h1>
                    <h2>CONTROL DE DIESEL</h2>
                </div>
            </div>
            <button id="btn-logout" class="button-danger no-print"><i class="fa-solid fa-right-from-bracket"></i>Cerrar Sesión</button>
        </div>

        <div class="container no-print">
            <div class="main-tabs">
                <button class="main-tab-link active" id="btnTabRegistrar"><i class="fa-solid fa-pencil"></i>Registrar</button>
                <button class="main-tab-link" id="btnTabReportes"><i class="fa-solid fa-chart-pie"></i>Reportes</button>
                <button class="main-tab-link" id="btnTabAdmin"><i class="fa-solid fa-gear"></i>Administración</button>
            </div>
        </div>

        <div id="tabRegistrar" class="main-tab-content no-print" style="display: block;">
            <div class="container">
                <h2><i class="fa-solid fa-file-circle-plus"></i>Registros de Consumo</h2>
                <p>Haz clic en el botón para añadir un nuevo registro de consumo de diésel.</p>
                <button id="btnAbrirModal" class="button-primary"><i class="fa-solid fa-plus"></i>Nuevo Registro</button>
            </div>
            <div id="modalRegistro" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <div id="formularioContainer">
                        <h2 id="formularioTitulo">Nuevo Registro</h2>
                        <form id="consumoForm"><input type="hidden" id="registroId"><label for="fecha">Fecha:</label><input type="date" id="fecha" required><label for="selectChofer">Nombre del Chofer:</label><select id="selectChofer" required></select><label for="selectVolqueta">Placa de la Volqueta:</label><select id="selectVolqueta" required></select><label for="selectProveedor">Proveedor de Diesel:</label><select id="selectProveedor" required></select><label for="selectProyecto">Proyecto:</label><select id="selectProyecto" required></select><label for="galones">Galones de Diésel (Volumen):</label><input type="number" id="galones" step="0.01" required><label for="costo">Costo Total ($):</label><input type="number" id="costo" step="0.01" required><label for="selectEmpresa">Empresa:</label><select id="selectEmpresa" required></select><label for="descripcion">Descripción del Uso:</label><textarea id="descripcion" required></textarea><button type="submit" id="btnGuardar" class="button-primary"><i class="fa-solid fa-floppy-disk"></i>Guardar Registro</button></form>
                    </div>
                </div>
            </div>
        </div>

        <div id="tabReportes" class="main-tab-content printable-section">
            <div class="container no-print">
                <div class="filter-section">
                    <div class="filter-group">
                        <div><label for="filtroMes">Por Mes:</label><select id="filtroMes"></select></div>
                        <div><label for="filtroFechaInicio">Por Rango:</label><input type="date" id="filtroFechaInicio" title="Desde la Fecha"></div>
                        <div><label for="filtroFechaFin">-</label><input type="date" id="filtroFechaFin" title="Hasta la Fecha"></div>
                    </div>
                    <div class="filter-group">
                        <div><label for="filtroChofer">Por Chofer:</label><select id="filtroChofer"></select></div>
                        <div><label for="filtroProveedor">Por Proveedor:</label><select id="filtroProveedor"></select></div>
                        <div><label for="filtroEmpresa">Por Empresa:</label><select id="filtroEmpresa"></select></div>
                        <div><label for="filtroProyecto">Por Proyecto:</label><select id="filtroProyecto"></select></div>
                    </div>
                     <div class="filter-group">
                         <button id="btnAplicarFiltros" class="button-success"><i class="fa-solid fa-filter"></i>Aplicar Filtros</button>
                         <button id="btnLimpiarFiltros" class="button-secondary"><i class="fa-solid fa-eraser"></i>Limpiar Filtros</button>
                         <button id="btnPrint" class="button-info" style="margin-left: auto;"><i class="fa-solid fa-print"></i>Imprimir Reporte</button>
                    </div>
                </div>
            </div>
            
            <div class="container" id="loaderContainer"><h2 id="loadingMessage" class="loader">Cargando datos desde la nube...</h2></div>
            
            <div class="container accordion-container">
                <button class="accordion-button">CONSUMO DE DIESEL POR EMPRESA</button><div class="accordion-panel"><table id="resumenEmpresaTabla"><thead><tr><th>Empresa</th><th>Total Galones (Volumen)</th><th>Costo Total ($)</th></tr></thead><tbody id="resumenEmpresaBody"></tbody><tfoot id="resumenEmpresaFooter"></tfoot></table></div>
                <button class="accordion-button">CONSUMO DE DIESEL POR PROVEEDOR</button><div class="accordion-panel"><table id="resumenProveedorTabla"><thead><tr><th>Proveedor</th><th>Total Galones (Volumen)</th><th>Costo Total ($)</th></tr></thead><tbody id="resumenProveedorBody"></tbody><tfoot id="resumenProveedorFooter"></tfoot></table></div>
                <button class="accordion-button">CONSUMO DE DIESEL POR PROYECTO</button><div class="accordion-panel"><table id="resumenProyectoTabla"><thead><tr><th>Proyecto</th><th>Total Galones (Volumen)</th><th>Costo Total ($)</th></tr></thead><tbody id="resumenProyectoBody"></tbody><tfoot id="resumenProyectoFooter"></tfoot></table></div>
                <button class="accordion-button">CONSUMO DE DIESEL POR CHOFER</button><div class="accordion-panel"><table id="resumenChoferTabla"><thead><tr><th>Chofer</th><th>Total Galones (Volumen)</th><th>Costo Total ($)</th></tr></thead><tbody id="resumenChoferBody"></tbody><tfoot id="resumenChoferFooter"></tfoot></table></div>
                <button class="accordion-button">CONSUMO DE DIESEL POR PLACA</button><div class="accordion-panel"><table id="resumenTabla"><thead><tr><th>Volqueta (Placa)</th><th>Total Galones (Volumen)</th><th>Costo Total ($)</th></tr></thead><tbody id="resumenBody"></tbody><tfoot id="resumenFooter"></tfoot></table></div>
                <button class="accordion-button">TOTAL DE CONSUMO DE DIESEL (HISTORIAL DETALLADO)</button>
                <div class="accordion-panel">
                    <table id="historialTabla">
                        <thead>
                            <tr>
                                <th class="no-print">Acciones</th><th>Fecha</th><th>Chofer</th><th>Placa</th><th>Proveedor</th><th>Proyecto</th><th>Galones</th><th>Costo ($)</th><th>Empresa</th><th>Descripción</th>
                            </tr>
                        </thead>
                        <tbody id="historialBody"></tbody>
                        <tfoot id="historialFooter"></tfoot>
                    </table>
                </div>
                <button class="accordion-button">GRÁFICO DE CONSUMO POR PLACA</button><div class="accordion-panel"><canvas id="graficoConsumo" style="max-height: 400px; width: 100%;"></canvas></div>
            </div>
        </div>

        <div id="tabAdmin" class="main-tab-content no-print">
            <div class="container" id="adminContainer">
                <h2><i class="fa-solid fa-screwdriver-wrench"></i>Administración</h2>
                <div class="admin-section">
                    <div class="admin-box"><h3><i class="fa-solid fa-user-tie"></i>Gestionar Choferes</h3><form id="formAdminChofer" class="admin-form"><input type="text" id="nuevoChofer" placeholder="Nombre completo" required><button type="submit" class="button-success"><i class="fa-solid fa-plus"></i>Agregar</button></form><ul id="listaChoferes" class="lista-gestion"></ul></div>
                    <div class="admin-box"><h3><i class="fa-solid fa-truck"></i>Gestionar Placas</h3><form id="formAdminPlaca" class="admin-form"><input type="text" id="nuevaPlaca" placeholder="Placa de la volqueta" required><button type="submit" class="button-success"><i class="fa-solid fa-plus"></i>Agregar</button></form><ul id="listaPlacas" class="lista-gestion"></ul></div>
                    <div class="admin-box"><h3><i class="fa-solid fa-building"></i>Gestionar Empresas</h3><form id="formAdminEmpresa" class="admin-form"><input type="text" id="nuevaEmpresa" placeholder="Nombre de la empresa" required><button type="submit" class="button-success"><i class="fa-solid fa-plus"></i>Agregar</button></form><ul id="listaEmpresas" class="lista-gestion"></ul></div>
                    <div class="admin-box"><h3><i class="fa-solid fa-dolly"></i>Gestionar Proveedores</h3><form id="formAdminProveedor" class="admin-form"><input type="text" id="nuevoProveedor" placeholder="Nombre del proveedor" required><button type="submit" class="button-success"><i class="fa-solid fa-plus"></i>Agregar</button></form><ul id="listaProveedores" class="lista-gestion"></ul></div>
                    <div class="admin-box"><h3><i class="fa-solid fa-list-check"></i>Gestionar Proyectos</h3><form id="formAdminProyecto" class="admin-form"><input type="text" id="nuevoProyecto" placeholder="Nombre del proyecto" required><button type="submit" class="button-success"><i class="fa-solid fa-plus"></i>Agregar</button></form><ul id="listaProyectos" class="lista-gestion"></ul></div>
                </div>
            </div>
        </div>
        
        <div class="signature-block printable-section">
            <div class="line"></div>
            Ing. José L. Macas P.<br>
            RESIDENTE DE OBRA
        </div>
    </div>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script type="module" src="script.js"></script>
</body>
</html>